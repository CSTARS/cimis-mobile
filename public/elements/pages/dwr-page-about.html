<dom-module id="dwr-page-about">
  <style include="shared-styles"></style>
  <style>
    :host {
      display: block;
      overflow: hidden;
    }
    p {
      padding : 0 15px;
      display : block;
    }
    .padding {
      padding : 0 15px;
      display : block;
    }
    iron-pages {
      margin: 15px;
    }

    h1, h2, h3, h4 {
      font-weight: 200;
    }

    paper-material {
      padding: 15px;
      margin: 15px;
    }
  </style>

  <template>

    <paper-tabs selected="{{selectedTab}}">
      <paper-tab>About</paper-tab>
      <paper-tab>Survey</paper-tab>
      <paper-tab>API</paper-tab>
      <paper-tab>Install</paper-tab>
      <paper-tab>Parameters</paper-tab>
      <paper-tab>Grid</paper-tab>
    </paper-tabs>

    <iron-pages selected="{{selectedTab}}">
      <div>
        <h1 id="about-header">About</h1>

        <div class="layout center">
          <div style="padding: 15px">
            <img class="media-object" src="/icons/cimis_icon_96.png" />
          </div>
          <div>
            <h2>CIMIS</h2>
            <div>The California Irrigation Management Information System (CIMIS) is designed
              to help growers develop efficient water budgets and irrigation strategies.
              CIMIS is a standardized way of accounting for water consumed through
              evapotranspiration (ET) by the soil and plants. The main purpose of
              CIMIS is to provide information for irrigation scheduling by matching the
              amount of water applied to a crop with needs of the plant.</div>
          </div>
        </div>

        <h2>Links</h2>

        <paper-menu>
          <paper-item><a href="http://www.cimis.water.ca.gov/" target="_blank">CIMIS Home</a></paper-item>
          <paper-item><a href="http://cimis.casil.ucdavis.edu/cimis/" target="_blank">Spatial CIMIS Data Directory</a></paper-item>
          <paper-item><a href="http://www.water.ca.gov/" target="_blank">DWR</a></paper-item>
        <paper-menu>
      </div>

      <div>
        <h1 id="survey-header">Survey</h1>
        <div class="help-block">Please help us understand who is using this app by marking the appropriate selection below.</div>

        <div class="layout">
          <label for="userTypeInput">I am:</label>
          <div>
            <div class="checkbox"> <label> <input type="radio" name="userType" value="farmer" on-click="updateUserType"> A Farmer</label> </div>
            <div class="checkbox"> <label> <input type="radio" name="userType" value="public" on-click="updateUserType"> General Public</label> </div>
            <div class="checkbox"> <label> <input type="radio" name="userType" checked value="unknown" on-click="updateUserType"> Prefer not to say</label> </div>
          </div>
        </div>
      </div>

      <div>
        <h1 id="api-header">API</h1>
        <div>
          <div>The last two weeks of Spatial CIMIS can be accessed using the follow Rest API calls.  All
            API responses are <a href="http://www.json.org/" target="_blanl">JSON</a> formatted.</div>

          <h2>By CIMIS Row/Column Id</h2>

          <paper-material>
            <p><span class="host"></span>/cimis/[ROW ID]/[COLUMN ID]</p>
            <p>Example: <a href="/cimis/190/131" target="_blank"><span class="host"></span>/cimis/190/131</a></p>
          </paper-material>

          <h2>By Latitude/Longitude</h2>

          <paper-material>
            <p><span class="host"></span>/cimis/ll/[LONGITUDE]/[LATITUDE]</p>
            <p>Example: <a href="/cimis/ll/-121.704/38.7240" target="_blank"><span class="host"></span>/cimis/ll/-121.704/38.7240</a></p>
          </paper-material>

          <h2>Get Current Dates</h2>
          <paper-material>
            <p>Get a list of available dates.</p>
            <p><a href="/cimis/dates" target="_blank"><span class="host"></span>/cimis/dates</a></p>
          </paper-material>
        </div>
      </div>

      <div>
        <h1 id="install-header">Install on Mobile</h1>
        <div>
          You can install this Spatial CIMIS app on your phone or tablet.  Once installed you
          access the Spatial CIMIS from the icon on your home screen.

          <paper-material>
            <h2>Chrome on Android</h2>
            <p>Click the <i class="fa fa-ellipsis-v"></i> menu icon, then click 'Add to Home Screen'</p>

            <h2>Safari on iOS</h2>
            <p>Click the <img src="/icons/bookmark.png" /> bookmark icon, then click 'Add to Home Screen'</p>
          </paper-material>
        </div>
      </div>

      <div>
        <h1 id="parameters-header">Spatial CIMIS Parameters</h1>
        <paper-material style="margin:0" id="parameters"></paper-material>
      </div>

      <div>
        <h1 class="page-header" id="grid-header">Spatial CIMIS Grid</h1>
        <paper-material>
          <div><a href="http://epsg.io/3310" target="_blank">EPSG:3310</a></div>
          <div><b>Number of Columns:</b> 510</div>
          <div><b>Number of Rows:</b> 560</div>
          <div><b>Left X Corner:</b> -410000</div>
          <div><b>Bottom Y Corner:</b> -660000</div>
          <div><b>Cell Size:</b> 2000</div>
        </paper-material>
      </div>
    </iron-pages>

  </template>
</dom-module>

<script>
  Polymer({
    is : 'dwr-page-about',

    properties : {
      selectedTab : {
        type : Number,
        value : 0
      }
    },

    attached : function() {
      this.querySelector('.host').innerHTML = window.location.protocol+'//'+window.location.host;
      this.createParamsTable();

      if( window.userType ) {
        this.querySelector('input[value="'+window.userType+'"]').checked = true;
      }
    },

    createParamsTable : function() {
      var table =
        '<table class="table">' +
          '<tr>' +
            '<th>Parameter</th><th>Name</th><th>Units</th>'+
          '</tr>';

      for( var param in CIMIS.definitions ) {
        table += '<tr>'+
          '<td>'+param+'</td><td>'+CIMIS.definitions[param].label+'</td><td>'+CIMIS.definitions[param].units+'</td></tr>';
      }
      this.$.parameters.innerHTML = table+'</table>';
    },

    updateUserType : function(e) {
      var type = e.currentTarget.value;

      window.localStorage.setItem('userType', type);
      window.userType = type;
    }
  })
</script>
